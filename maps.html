<!DOCTYPE html>
<html>
  <head>
    <title>Heat Map</title>
   
    <meta charset="utf-8">
    <style>
      html, body, #map-canvas {
        margin: 0;
        padding: 0%;
        height: 95%;
      }
    </style>
    
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&libraries=visualization,places"></script>
        

        <script>
// Adding 500 Data Points
var map, pointarray
var heatmap = new google.maps.visualization.HeatmapLayer(null);
var infowindow;
var mapData = new Array();
var myNum = 1;

var markers = new Array();
var map;
var pointArray;



function initialize() {
			
	  testNum = 51.503951;	
	  var  pyrmont = new google.maps.LatLng(51.503951, -0.019773);
	  

	  var mapOptions = {
			    
			    center: pyrmont,
			    mapTypeId: google.maps.MapTypeId.SATELLITE,
			    streetViewControl: false,
			    panControl: false,
			    mapTypeControl: false,
			    zoom: 2,
			    
			  };


			  map = new google.maps.Map(document.getElementById('map-canvas'),
			      mapOptions);
			 
	  

	  var request = {

	    location: pyrmont,
	    radius: 500,
	    types: ['cafe']
	  };
	  
	  infowindow = new google.maps.InfoWindow();
	  var service = new google.maps.places.PlacesService(map);
	  service.radarSearch(request, callback);
		}
	  

	  


function callback(results, status) {
	  if (status == google.maps.places.PlacesServiceStatus.OK) {
		  
		 
		  
		  
	    for (var i = 0; i < results.length; i++) {
		      pLoc = results[i].geometry.location;
		      //mapData.push(new google.maps.LatLng(pLoc["jb"], pLoc["kb"]));
	    	  //createMarker(results[i],results[i].name);
	    }
	  }
	}
	
function createMarker(place,mDIn) {
	  var placeLoc = place.geometry.location;
	  
	 var marker = new google.maps.Marker({
		    map: map,
		    position: place.geometry.location,
		    //icon: "http://www.google.com/intl/en_us/mapfiles/ms/micons/blue-dot.png"
		  });

	  markers.push(marker);
	 
	     
	  tNum = myNum;
	  //google.maps.event.addListener(marker, 'click', function() {
	  //  infowindow.setContent(JSON.stringify(mDIn));
	  //  infowindow.open(map, this);
	  //});

	}
	
function toggleHeatmap() {
	  heatmap.setMap(heatmap.getMap() ? null : map);
	}
	
function changeGradient() {
	  var gradient = [
	    'rgba(0, 255, 255, 0)',
	    'rgba(0, 255, 255, 1)',
	    'rgba(0, 191, 255, 1)',
	    'rgba(0, 127, 255, 1)',
	    'rgba(0, 63, 255, 1)',
	    'rgba(0, 0, 255, 1)',
	    'rgba(0, 0, 223, 1)',
	    'rgba(0, 0, 191, 1)',
	    'rgba(0, 0, 159, 1)',
	    'rgba(0, 0, 127, 1)',
	    'rgba(63, 0, 91, 1)',
	    'rgba(127, 0, 63, 1)',
	    'rgba(191, 0, 31, 1)',
	    'rgba(255, 0, 0, 1)'
	  ]
	  heatmap.setOptions({
	    gradient: heatmap.get('gradient') ? null : gradient
	  });
	}
	
function changeRadius() {
	  heatmap.setOptions({radius: heatmap.get('radius') ? null : 20});
	}
	
	
function getMapData(){

	
	var bounds = map.getBounds();
	var ne = bounds.getNorthEast(); // LatLng of the north-east corner
	var sw = bounds.getSouthWest(); // LatLng of the south-west corder
	var nw = new google.maps.LatLng(ne.lat(), sw.lng());
	var se = new google.maps.LatLng(sw.lat(), ne.lng());
	
	
	//for (var i = 0; i < heatmap.length; i++ ) {
		heatmap.setMap(null);
	//}
	mapData = [];
	pointArray = [];
	
	myLat = 51.503951;

	 -0.019773
	for (var i=1;i<5;i++){
			myLong = -0.019773;
			myLat = myLat ;
		for (var j=1;j<5;j++){	
			myLong = myLong ;
			//Math.random()/5
  			mapData.push(new google.maps.LatLng(myLat+Math.random()/5,myLong+Math.random()/5));
		}
	}
	
	  pointArray = new google.maps.MVCArray(mapData);

	  
	  
	  heatmap = new google.maps.visualization.HeatmapLayer({
	    data: pointArray
	  });

	 
	  heatmap.setMap(map);
	  heatmap.setOptions({opacity: heatmap.get('opacity') ? null : 0.3});
	  heatmap.setOptions({radius: heatmap.get('radius') ? null : 20});

	
	
}
	
function changeOpacity() {
	  heatmap.setOptions({opacity: heatmap.get('opacity') ? null : 0.2});
	}

// == shows all markers of a particular category, and ensures the checkbox is checked ==
function toggleMarker() {
  for (var i=0; i<markers.length; i++) {
	  if(markers[i].getVisible()==true){
      	 markers[i].setVisible(false); // call the setVisible method of the marker
  	   }else{
  		 markers[i].setVisible(true);
  	    }
  }
}


google.maps.event.addDomListener(window, 'load', initialize);





function printData(){
	
	document.write("test");
	
    for (var i=0; i<mapData.length; i++) {
			document.write(mapData[i]);
    }
    
    
    
    
     var form = document.createElement("form");
    form.setAttribute("method", "post");
    form.setAttribute("action", "/");
     var hiddenField = document.createElement("input");
     hiddenField.setAttribute("type", "hidden");
     hiddenField.setAttribute("name", "name");
      hiddenField.setAttribute("value", "1");
     form.appendChild(hiddenField);
   document.body.appendChild(form);
    form.submit(); 
    
    return false;
    
	
}


	

//

  </script>
  
  
  
</head>
<body>



 <div id="panel">
   <!-- <button onclick="toggleHeatmap()">Toggle Heatmap</button>
    <button onclick="changeGradient()">Change gradient</button>
    <button onclick="changeRadius()">Change radius</button>
    <button onclick="changeOpacity()">Change opacity</button>
     <button onclick="toggleMarker()">Marker On/Off</button> 
    <button onclick="getMapData()">Refresh</button>-->
    
    
  </div>

<script>
setTimeout(function() {
    getMapData()
}, 1000);
</script>
  <div id="map-canvas"></div>
  
  <script>
â€‹
  </script>
  
</body>
</html>